(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[366],{29230:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/websites/[id]",function(){return n(17482)}])},16822:function(e,s,n){"use strict";n.d(s,{Z:function(){return X}});var t=n(85893),l=n(29120),i=n(9008),r=n.n(i),a=n(41664),c=n.n(a),o=n(11163),d=n(94184),u=n.n(d),x=n(43756),h=n(80483),j=n(52438),m=n(44085),v=n(18927),_=n(35177),b=n.n(_),f=n(91998),p=n(83454),g=function(){let{formatMessage:e,labels:s}=(0,m.Z)(),{user:n}=(0,v.Z)(),i=(0,o.useRouter)(),{dir:r}=(0,f.Z)(),a=!!p.env.cloudMode;return(0,t.jsxs)(l.qh,{children:[(0,t.jsxs)(l.zx,{variant:"quiet",children:[(0,t.jsx)(l.JO,{children:(0,t.jsx)(x.Z.Profile,{})}),(0,t.jsx)(l.JO,{size:"sm",children:(0,t.jsx)(x.Z.ChevronDown,{})})]}),(0,t.jsx)(l.GI,{position:"bottom",alignment:"rtl"===r?"start":"end",children:(0,t.jsxs)(l.v2,{variant:"popup",onSelect:e=>{"profile"===e&&i.push("/settings/profile"),"logout"===e&&i.push("/logout")},className:b().menu,children:[(0,t.jsx)(l.ck,{className:b().item,children:(0,t.jsx)(l.xv,{children:n.username})},"user"),(0,t.jsxs)(l.ck,{className:b().item,divider:!0,children:[(0,t.jsx)(l.JO,{children:(0,t.jsx)(x.Z.User,{})}),(0,t.jsx)(l.xv,{children:e(s.profile)})]},"profile"),!a&&(0,t.jsxs)(l.ck,{className:b().item,children:[(0,t.jsx)(l.JO,{children:(0,t.jsx)(x.Z.Logout,{})}),(0,t.jsx)(l.xv,{children:e(s.logout)})]},"logout")]})})]})},N=n(67294),y=n(73935),w=n(93766),Z=n.n(w),k=function(e){let{items:s=[],onClose:n}=e,{pathname:l}=(0,o.useRouter)(),i=e=>{let{items:s,className:r}=e;return(0,t.jsx)("div",{className:u()(Z().items,r),children:s.map(e=>{let{label:s,url:r,children:a}=e,o=l.startsWith(r);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c(),{href:r,className:u()(Z().item,{[Z().selected]:o}),onClick:n,children:s},r),a&&(0,t.jsx)(i,{items:a,className:Z().submenu})]})})})};return(0,y.createPortal)((0,t.jsx)("div",{className:u()(Z().menu),children:(0,t.jsx)(i,{items:s})}),document.body)},S=n(83454),C=function(){let{formatMessage:e,labels:s}=(0,m.Z)(),[n,i]=(0,N.useState)(!1),r=!!S.env.cloudMode,a=[{label:e(s.dashboard),url:"/dashboard"},!r&&{label:e(s.settings),url:"/settings",children:[{label:e(s.websites),url:"/settings/websites"},{label:e(s.teams),url:"/settings/teams"},{label:e(s.users),url:"/settings/users"},{label:e(s.profile),url:"/settings/profile"}]},r&&{label:e(s.profile),url:"/settings/profile"},!r&&{label:e(s.logout),url:"/logout"}].filter(e=>e);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.zx,{variant:"quiet",onClick:()=>i(e=>!e),children:(0,t.jsx)(l.JO,{children:n?(0,t.jsx)(x.Z.Close,{}):(0,t.jsx)(x.Z.Menu,{})})}),n&&(0,t.jsx)(k,{items:a,onClose:()=>i(!1)})]})},M=n(52963),R=n.n(M),B=function(){let{pathname:e}=(0,o.useRouter)(),{formatMessage:s,labels:n}=(0,m.Z)(),i=[{label:s(n.dashboard),url:"/dashboard"},{label:s(n.websites),url:"/websites"},{label:s(n.reports),url:"/reports"},{label:s(n.settings),url:"/settings"}].filter(e=>e);return(0,t.jsx)("div",{className:u()(R().navbar),children:(0,t.jsxs)(l.X2,{children:[(0,t.jsxs)(l.sg,{className:R().left,children:[(0,t.jsxs)("div",{className:R().logo,children:[(0,t.jsx)(l.JO,{size:"lg",children:(0,t.jsx)(x.Z.Logo,{})}),(0,t.jsx)(l.xv,{className:R().text,children:"umami"})]}),(0,t.jsx)("div",{className:R().links,children:i.map(s=>{let{url:n,label:i}=s;return(0,t.jsx)(c(),{href:n,className:u()({[R().selected]:e.startsWith(n)}),children:(0,t.jsx)(l.xv,{children:i})},n)})})]}),(0,t.jsxs)(l.sg,{className:R().right,children:[(0,t.jsxs)("div",{className:R().actions,children:[(0,t.jsx)(h.Z,{}),(0,t.jsx)(j.Z,{}),(0,t.jsx)(g,{})]}),(0,t.jsx)("div",{className:R().mobile,children:(0,t.jsx)(C,{})})]})]})})},W=n(32955),z=n(64529),E=n(12902),U=n(81249),I=n.n(U),L=n(73865);let O={current:L.we,latest:null,hasUpdate:!1,checked:!1,releaseUrl:null},P=(0,z.Ue)(()=>({...O}));async function A(){let{current:e}=P.getState(),s=await fetch("".concat(L.nI,"?v=").concat(e),{method:"GET",headers:{Accept:"application/json"}}).then(e=>e.ok?e.json():null);s&&P.setState((0,E.Uy)(n=>{let{latest:t,url:l}=s,i=(0,W.rV)(L.aC),r=!!(t&&(null==i?void 0:i.version)!==t&&I().gt(t,e));return n.current=e,n.latest=t,n.hasUpdate=r,n.checked=!0,n.releaseUrl=l,n}))}var F=n(82299),T=n.n(F),q=function(e){let{user:s,config:n}=e,{formatMessage:i,labels:r,messages:a}=(0,m.Z)(),{latest:c,checked:d,hasUpdate:u,releaseUrl:x}=P(),{pathname:h}=(0,o.useRouter)(),[j,v]=(0,N.useState)(d),_=(null==s?void 0:s.isAdmin)&&!(null==n?void 0:n.updatesDisabled)&&!(null==n?void 0:n.cloudMode)&&!h.includes("/share/")&&!j,b=(0,N.useCallback)(()=>{(0,W.LS)(L.aC,{version:c,time:Date.now()})},[c]);return((0,N.useEffect)(()=>{_&&A()},[_]),_&&u)?(0,y.createPortal)((0,t.jsxs)(l.X2,{className:T().notice,children:[(0,t.jsx)(l.sg,{variant:"two",className:T().message,children:i(a.newVersionAvailable,{version:"v".concat(c)})}),(0,t.jsxs)(l.sg,{className:T().buttons,children:[(0,t.jsx)(l.zx,{variant:"primary",onClick:function(){b(),v(!0),open(x||L.Bv,"_blank")},children:i(r.viewDetails)}),(0,t.jsx)(l.zx,{onClick:function(){b(),v(!0)},children:i(r.dismiss)})]})]}),document.body):null},D=n(24474),J=n(51327),V=n.n(J),X=function(e){let{title:s,children:n}=e,{user:i}=(0,D.Gb)(),a=(0,D.ZR)();return!i||!a||(null==a?void 0:a.uiDisabled)?null:(0,t.jsxs)("div",{className:V().layout,children:[(0,t.jsx)(q,{user:i,config:a}),(0,t.jsx)(r(),{children:(0,t.jsx)("title",{children:s?"".concat(s," | umami"):"umami"})}),(0,t.jsx)("nav",{className:V().nav,children:(0,t.jsx)(B,{})}),(0,t.jsx)("main",{className:V().body,children:(0,t.jsx)(l.W2,{children:n})})]})}},70790:function(e,s,n){"use strict";var t=n(85893),l=n(94184),i=n.n(l),r=n(29120),a=n(44085),c=n(84325),o=n.n(c);s.Z=function(e){let{className:s,error:n,loading:l,children:c}=e,{formatMessage:d,messages:u}=(0,a.Z)();return n?(0,t.jsx)(r.jL,{variant:"error",children:d(u.error)}):l?(0,t.jsx)(r.gb,{icon:"spinner",size:"xl",position:"page"}):(0,t.jsx)("div",{className:i()(o().page,s),children:c})}},56754:function(e,s,n){"use strict";var t=n(85893),l=n(94184),i=n.n(l);n(67294);var r=n(74282),a=n.n(r);s.Z=function(e){let{title:s,children:n,className:l}=e;return(0,t.jsxs)("div",{className:i()(a().header,l),children:[s&&(0,t.jsx)("div",{className:a().title,children:s}),(0,t.jsx)("div",{className:a().actions,children:n})]})}},7255:function(e,s,n){"use strict";var t=n(85893),l=n(29120),i=n(11163),r=n(60481),a=n(18927),c=n(44085),o=n(35742),d=n.n(o),u=n(83454);s.Z=function(e){var s;let{children:n}=e,{user:o}=(0,a.Z)(),{pathname:x}=(0,i.useRouter)(),{formatMessage:h,labels:j}=(0,c.Z)(),m=!!u.env.cloudMode,v=[{key:"websites",label:h(j.websites),url:"/settings/websites"},{key:"teams",label:h(j.teams),url:"/settings/teams"},o.isAdmin&&{key:"users",label:h(j.users),url:"/settings/users"},{key:"profile",label:h(j.profile),url:"/settings/profile"}].filter(e=>e);return(0,t.jsxs)(l.X2,{children:[!m&&(0,t.jsx)(l.sg,{className:d().menu,defaultSize:12,md:4,lg:3,xl:2,children:(0,t.jsx)(r.Z,{items:v,shallow:!0,selectedKey:null===(s=v.find(e=>{let{url:s}=e;return x===s}))||void 0===s?void 0:s.key})}),(0,t.jsx)(l.sg,{className:d().content,defaultSize:12,md:8,lg:9,xl:10,children:n})]})}},60481:function(e,s,n){"use strict";var t=n(85893),l=n(94184),i=n.n(l),r=n(29120),a=n(11163),c=n(41664),o=n.n(c),d=n(56547),u=n.n(d);s.Z=function(e){let{selectedKey:s,items:n,shallow:l=!0,scroll:c=!1,onSelect:d=()=>{}}=e,{asPath:x}=(0,a.useRouter)();return(0,t.jsx)(r.v2,{items:n,selectedKey:s,className:u().menu,onSelect:d,children:e=>{let{key:s,label:n,url:a}=e;return(0,t.jsx)(r.ck,{className:i()(u().item,{[u().selected]:x.startsWith(a)}),children:(0,t.jsx)(o(),{href:a,shallow:l,scroll:c,children:n})},s)}})}},17482:function(e,s,n){"use strict";n.r(s),n.d(s,{__N_SSP:function(){return R},default:function(){return B}});var t=n(85893),l=n(16822),i=n(11163),r=n(67294),a=n(29120),c=n(41664),o=n.n(c),d=n(70790),u=n(56754),x=n(35338),h=n(73865),j=n(44085),m=function(e){let{websiteId:s,data:n,onSave:l}=e,{formatMessage:i,labels:c,messages:o}=(0,j.Z)(),{post:d,useMutation:u}=(0,x.Z)(),{mutate:m,error:v}=u(e=>d("/websites/".concat(s),e)),_=(0,r.useRef)(null),b=async e=>{m(e,{onSuccess:async()=>{_.current.reset(e),l(e)}})};return(0,t.jsxs)(a.l0,{ref:_,onSubmit:b,error:v,values:n,children:[(0,t.jsx)(a.p7,{label:i(c.websiteId),children:(0,t.jsx)(a.nv,{value:s,readOnly:!0,allowCopy:!0})}),(0,t.jsx)(a.p7,{label:i(c.name),children:(0,t.jsx)(a.Tr,{name:"name",rules:{required:i(c.required)},children:(0,t.jsx)(a.nv,{})})}),(0,t.jsx)(a.p7,{label:i(c.domain),children:(0,t.jsx)(a.Tr,{name:"domain",rules:{required:i(c.required),pattern:{value:h.Xx,message:i(o.invalidDomain)}},children:(0,t.jsx)(a.nv,{})})}),(0,t.jsx)(a.Au,{children:(0,t.jsx)(a.Mm,{variant:"primary",children:i(c.save)})})]})};let v="DELETE";var _=function(e){let{websiteId:s,onSave:n,onClose:l}=e,{formatMessage:i,labels:r,messages:c,FormattedMessage:o}=(0,j.Z)(),{del:d,useMutation:u}=(0,x.Z)(),{mutate:h,error:m}=u(e=>d("/websites/".concat(s),e)),_=async e=>{h(e,{onSuccess:async()=>{n(),l()}})};return(0,t.jsxs)(a.l0,{onSubmit:_,error:m,children:[(0,t.jsx)("p",{children:(0,t.jsx)(o,{...c.deleteWebsite,values:{confirmation:(0,t.jsx)("b",{children:v})}})}),(0,t.jsx)(a.p7,{label:i(r.confirm),children:(0,t.jsx)(a.Tr,{name:"confirmation",rules:{validate:e=>e===v},children:(0,t.jsx)(a.nv,{autoComplete:"off"})})}),(0,t.jsxs)(a.Au,{flex:!0,children:[(0,t.jsx)(a.Mm,{variant:"danger",children:i(r.delete)}),(0,t.jsx)(a.zx,{onClick:l,children:i(r.cancel)})]})]})};let b="RESET";var f=function(e){let{websiteId:s,onSave:n,onClose:l}=e,{formatMessage:i,labels:r,messages:c,FormattedMessage:o}=(0,j.Z)(),{post:d,useMutation:u}=(0,x.Z)(),{mutate:h,error:m}=u(e=>d("/websites/".concat(s,"/reset"),e)),v=async e=>{h(e,{onSuccess:async()=>{n(),l()}})};return(0,t.jsxs)(a.l0,{onSubmit:v,error:m,children:[(0,t.jsx)("p",{children:(0,t.jsx)(o,{...c.resetWebsite,values:{confirmation:(0,t.jsx)("b",{children:b})}})}),(0,t.jsx)(a.p7,{label:i(r.confirm),children:(0,t.jsx)(a.Tr,{name:"confirm",rules:{validate:e=>e===b},children:(0,t.jsx)(a.nv,{autoComplete:"off"})})}),(0,t.jsxs)(a.Au,{flex:!0,children:[(0,t.jsx)(a.Mm,{variant:"danger",children:i(r.reset)}),(0,t.jsx)(a.zx,{onClick:l,children:i(r.cancel)})]})]})},p=function(e){let{websiteId:s,onSave:n}=e,{formatMessage:l,labels:i,messages:r}=(0,j.Z)(),c=async()=>{n("reset")},o=async()=>{n("delete")};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.yt,{label:l(i.resetWebsite),description:l(r.resetWebsiteWarning),children:(0,t.jsxs)(a.iq,{children:[(0,t.jsx)(a.zx,{variant:"secondary",children:l(i.reset)}),(0,t.jsx)(a.u_,{title:l(i.resetWebsite),children:e=>(0,t.jsx)(f,{websiteId:s,onSave:c,onClose:e})})]})}),(0,t.jsx)(a.yt,{label:l(i.deleteWebsite),description:l(r.deleteWebsiteWarning),children:(0,t.jsxs)(a.iq,{children:[(0,t.jsx)(a.zx,{variant:"danger",children:l(i.delete)}),(0,t.jsx)(a.u_,{title:l(i.deleteWebsite),children:e=>(0,t.jsx)(_,{websiteId:s,onSave:o,onClose:e})})]})})]})},g=n(25820),N=n(83454),y=function(e){var s,n,l;let{websiteId:r}=e,{formatMessage:c,messages:o}=(0,j.Z)(),{basePath:d}=(0,i.useRouter)(),u=(0,g.Z)(),x=(null==u?void 0:null===(l=u.trackerScriptName)||void 0===l?void 0:null===(n=l.split(","))||void 0===n?void 0:null===(s=n.map(e=>e.trim()))||void 0===s?void 0:s[0])||"script.js",h=(null==x?void 0:x.startsWith("http"))?x:"".concat(N.env.analyticsUrl||location.origin).concat(d,"/").concat(x),m='<script async src="'.concat(h,'" data-website-id="').concat(r,'"></script>');return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:c(o.trackingCode)}),(0,t.jsx)(a.Kx,{rows:4,value:m,readOnly:!0,allowCopy:!0})]})},w=n(32955),Z=n(83454);let k=()=>(0,w.BY)(16);var S=function(e){let{websiteId:s,data:n,onSave:l}=e,{formatMessage:c,labels:o,messages:d}=(0,j.Z)(),{name:u,shareId:h}=n,[m,v]=(0,r.useState)(h),{post:_,useMutation:b}=(0,x.Z)(),{basePath:f}=(0,i.useRouter)(),{mutate:p,error:g}=b(e=>{let{shareId:n}=e;return _("/websites/".concat(s),{shareId:n})}),N=(0,r.useRef)(null),y=(0,r.useMemo)(()=>"".concat(Z.env.analyticsUrl||location.origin).concat(f,"/share/").concat(m,"/").concat(encodeURIComponent(u)),[m,u,f]),w=async e=>{p(e,{onSuccess:async()=>{l(e),N.current.reset(e)}})};return(0,r.useEffect)(()=>{m&&m!==h&&N.current.setValue("shareId",m)},[m,h]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.ZD,{checked:!!m,onChecked:e=>{let s={shareId:e?k():null};p(s,{onSuccess:async()=>{l(s)}}),v(s.shareId)},style:{marginBottom:30},children:c(o.enableShareUrl)}),m&&(0,t.jsxs)(a.l0,{ref:N,onSubmit:w,error:g,values:n,children:[(0,t.jsxs)(a.p7,{children:[(0,t.jsx)("p",{children:c(d.shareUrl)}),(0,t.jsxs)(a.DL,{gap:10,children:[(0,t.jsx)(a.nv,{value:y,readOnly:!0,allowCopy:!0}),(0,t.jsx)(a.zx,{onClick:()=>{let e=k();N.current.setValue("shareId",e,{shouldValidate:!0,shouldDirty:!0}),v(e)},children:c(o.regenerate)})]})]}),(0,t.jsx)(a.Au,{children:(0,t.jsx)(a.Mm,{variant:"primary",children:c(o.save)})})]},s)]})},C=function(e){let{websiteId:s,openExternal:n=!1}=e,l=(0,i.useRouter)(),{formatMessage:c,labels:h,messages:v}=(0,j.Z)(),{get:_,useQuery:b}=(0,x.Z)(),{showToast:f}=(0,a.e1)(),{data:g,isLoading:N}=b(["website",s],()=>_("/websites/".concat(s)),{enabled:!!s,cacheTime:0}),[w,Z]=(0,r.useState)(null),[k,C]=(0,r.useState)("details"),M=()=>{f({message:c(v.saved),variant:"success"})},R=e=>{M(),Z(s=>({...s,...e}))},B=async e=>{"delete"===e?await l.push("/settings/websites"):"reset"===e&&M()};return(0,r.useEffect)(()=>{g&&Z(g)},[g]),(0,t.jsxs)(d.Z,{loading:N||!w,children:[(0,t.jsx)(u.Z,{title:null==w?void 0:w.name,children:(0,t.jsx)(o(),{href:"/websites/".concat(s),target:n?"_blank":null,children:(0,t.jsxs)(a.zx,{variant:"primary",children:[(0,t.jsx)(a.JO,{children:(0,t.jsx)(a.PJ.External,{})}),(0,t.jsx)(a.xv,{children:c(h.view)})]})})}),(0,t.jsxs)(a.mQ,{selectedKey:k,onSelect:C,style:{marginBottom:30},children:[(0,t.jsx)(a.ck,{children:c(h.details)},"details"),(0,t.jsx)(a.ck,{children:c(h.trackingCode)},"tracking"),(0,t.jsx)(a.ck,{children:c(h.shareUrl)},"share"),(0,t.jsx)(a.ck,{children:c(h.data)},"data")]}),"details"===k&&(0,t.jsx)(m,{websiteId:s,data:w,onSave:R}),"tracking"===k&&(0,t.jsx)(y,{websiteId:s,data:w}),"share"===k&&(0,t.jsx)(S,{websiteId:s,data:w,onSave:R}),"data"===k&&(0,t.jsx)(p,{websiteId:s,onSave:B})]})},M=n(7255),R=!0;function B(e){let{disabled:s}=e,n=(0,i.useRouter)(),{id:r}=n.query,{formatMessage:a,labels:c}=(0,j.Z)();return!r||s?null:(0,t.jsx)(l.Z,{title:"".concat(a(c.settings)," - ").concat(a(c.websites)),children:(0,t.jsx)(M.Z,{children:(0,t.jsx)(C,{websiteId:r})})})}},93766:function(e){e.exports={menu:"MobileMenu_menu__DO6aZ",items:"MobileMenu_items__N_NHj",item:"MobileMenu_item__iN83G",selected:"MobileMenu_selected__Z1kQJ",submenu:"MobileMenu_submenu__eW8zr"}},82299:function(e){e.exports={notice:"UpdateNotice_notice__vSRjT",message:"UpdateNotice_message__ntCR8",buttons:"UpdateNotice_buttons__F6euy"}},35177:function(e){e.exports={menu:"ProfileButton_menu__NQdVL",item:"ProfileButton_item__FBiu1"}},51327:function(e){e.exports={layout:"AppLayout_layout__8Fgjq",nav:"AppLayout_nav__Bmoe1",body:"AppLayout_body__pAojL"}},52963:function(e){e.exports={navbar:"NavBar_navbar__1L4iC",left:"NavBar_left__xjgkC",right:"NavBar_right__G2alC",logo:"NavBar_logo__0W9iy",links:"NavBar_links__Sh5Fe",selected:"NavBar_selected__jgveb",actions:"NavBar_actions__CpMkm",mobile:"NavBar_mobile__NlFK6"}},84325:function(e){e.exports={page:"Page_page__xxbhi"}},74282:function(e){e.exports={header:"PageHeader_header__8CvHt",title:"PageHeader_title__m8eFY",actions:"PageHeader_actions__6l2hP"}},35742:function(e){e.exports={menu:"SettingsLayout_menu__7reR6",content:"SettingsLayout_content__hSAEC"}},56547:function(e){e.exports={menu:"SideNav_menu__NOTB5",item:"SideNav_item__jN5F4",selected:"SideNav_selected__V2_83"}}},function(e){e.O(0,[678,885,668,762,249,67,774,888,179],function(){return e(e.s=29230)}),_N_E=e.O()}]);